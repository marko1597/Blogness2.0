var ngComments,ngConfig,ngError,ngHeader,ngLogger,ngLogin,blog,ngMedia,ngMessaging,ngNavigation,ngPosts,ngShared,ngBlogSockets,ngTags,ngUser;window.blogInit={};window.blogInit={start:function(){var n=angular.element(document.querySelector("[ng-app]")).injector().get("configProvider");n.setBlogSockets(window.blogConfiguration.blogSockets);n.setBlogApiEndpoint(window.blogConfiguration.blogApi);n.setBlogRoot(window.blogConfiguration.blogRoot);n.setBlogSocketsAvailability(window.blogConfiguration.blogSocketsAvailable);n.setDimensions(window.innerWidth,window.innerHeight);n.setNavigationItems([{text:"Home",icon:"fa-home",href:"/#/"},{text:"People",icon:"fa-user",href:"/#/user"},{text:"Friends",icon:"fa-comments",href:"/#/friends"},{text:"Groups",icon:"fa-users",href:"/#/groups"},{text:"Events",icon:"fa-calendar",href:"/#/events"}]);n.setDefaultProfilePicture(window.blogConfiguration.blogApi+"media/defaultprofilepicture");n.setDefaultBackgroundPicture(window.blogConfiguration.blogApi+"media/defaultbackgroundpicture");n.setSocketClientFunctions(window.socketClientFunctions);ngLogger.provider("$exceptionHandler",{$get:function(n){return n}})}};ngComments=angular.module("ngComments",["ngShared","iso.directives","ngConfig","LocalStorageModule"]);ngComments.directive("commentItem",[function(){var n=function(n,t,i,r,u){n.canExpandComment=function(){return n.allowExpand?n.comment.Comments==undefined||n.comment.Comments===null||n.comment.Comments.length<1?!1:!0:!1};n.toggleReplies=function(){var i=!n.comment.ShowReplies;n.comment.ShowReplies=i;i||t.$broadcast("hideAddReply")};n.isExpanded=function(){return n.comment.ShowReplies?"fa-minus":"fa-plus"};n.canReplyToComment=function(){return n.allowReply?n.comment.PostId===null||n.comment.PostId==0?"hidden":"":"hidden"};n.showAddReply=function(){n.comment.ShowAddReply=!0;n.comment.ShowReplies||(n.toggleReplies(),n.isExpanded())};n.isUserLiked=function(){var t=!1;return _.each(n.comment.CommentLikes,function(i){i.UserId==n.user.Id&&(t=!0)}),t?"fa-star":"fa-star-o"};n.isFromPostOwner=function(){return n.comment.User&&n.poster&&n.comment.User.UserName==n.poster?"":"hidden"};n.likeComment=function(){i.likeComment(n.comment.Id,n.user.UserName).then(function(){},function(n){r.displayError(n)})};n.$on(u.getSocketClientFunctions().commentLikesUpdate,function(t,i){n.comment.Id==i.commentId&&(n.comment.CommentLikes=i.commentLikes,n.$apply(),$(".comment-likes-count[data-comment-id='"+i.commentId+"']").effect("highlight",{color:"#B3C833"},1500),n.isUserLiked())});t.$on("hideAddReply",function(){n.comment.ShowAddReply=!1})},t;return n.$inject=["$scope","$rootScope","commentsService","errorService","configProvider"],t=function(n,t,i){n.allowReply=i.allowReply==="true"?!0:!1;n.allowExpand=i.allowExpand==="true"?!0:!1},{restrict:"EA",scope:{comment:"=",user:"=",poster:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"comments/commentItem.html",controller:n,link:t}}]);ngComments.directive("commentsAddNew",[function(){var n=function(n,t,i,r){n.comment={CommentMessage:"",PostId:n.postid,ParentCommentId:n.commentid,User:n.user};n.hasError=!1;n.commentMessageStyle=function(){return n.hasError?r.highlightField():""};n.removeCommentMessageError=function(){n.hasError=!1};n.hideAddComment=function(){n.commentid==undefined||n.commentid==null?t.$broadcast("hideAddComment"):t.$broadcast("hideAddReply")};n.saveComment=function(){n.comment.CommentMessage!=""?i.addComment(n.createCommentForAdding()).then(function(t){t.Error==undefined?(n.comment.CommentMessage="",n.hideAddComment()):(n.hasError=!0,r.displayError(t.Error))},function(n){r.displayError(n)}):(n.hasError=!0,r.displayError({Message:"Your comment message is empty. Please don't be that stupid."}))};n.createCommentForAdding=function(){return n.comment.ParentCommentId?(n.comment.PostId=n.parentpostid,n.comment):n.comment};t.$watch("user",function(){t.user&&(n.comment.User=t.user)})};return n.$inject=["$scope","$rootScope","commentsService","errorService"],{restrict:"EA",scope:{commentid:"=",postid:"=",user:"=",parentpostid:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"comments/commentsAddNew.html",controller:n}}]);ngComments.directive("commentsContainer",[function(){var n=function(n){n.showAddComment=!1;n.toggleShowAddComment=function(){n.showAddComment=!n.showAddComment};n.$on("hideAddComment",function(){n.showAddComment=!1})};return n.$inject=["$scope"],{restrict:"EA",scope:{user:"=",postid:"=",poster:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"comments/commentsContainer.html",controller:n}}]);ngComments.directive("commentsList",[function(){var n=function(n,t,i,r,u,f,e){n.comments=[];n.emptyCommentsMessage="";n.hasError=!1;n.getComments=function(){isNaN(n.postid)?n.hasError=!0:r.getCommentsByPost(n.postid).then(function(t){n.hasError=!1;n.comments=t;i.subscribeToPost(n.postid)},function(t){n.hasError=!0;f.displayError(t)})};n.showEmptyCommentsMessage=function(){return n.comments.length!=0?!1:!0};n.emptyMessageStyle=function(){return n.hasError?"alert-danger":"alert-warning"};n.getEmptyCommentsMessage=function(){return n.hasError?"Something went wrong with loading the comments! :(":"There are no comments yet."};n.$on(e.getSocketClientFunctions().commentAdded,function(t,i){if(i.comment=r.addViewProperties(i.comment),i.commentId!==null&&i.commentId!=undefined){var u=_.where(n.comments,{Id:i.commentId})[0];u.Comments===null&&(u.Comments=[]);u.Comments.unshift(i.comment);n.$apply();$(".comment-item[data-comment-id='"+i.comment.Id+"']").effect("highlight",{color:"#B3C833"},1500);$(".comment-item[data-comment-id='"+i.comment.ParentCommentId+"']").effect("highlight",{color:"#B3C833"},1500)}else n.comments.unshift(i.comment),n.$apply(),$(".comment-item[data-comment-id='"+i.comment.Id+"']").effect("highlight",{color:"#B3C833"},1500)});t.$on(e.getSocketClientFunctions().wsConnect,function(){i.subscribeToPost(n.postid)});n.getComments()};return n.$inject=["$scope","$rootScope","postsService","commentsService","userService","errorService","configProvider"],{restrict:"EA",scope:{user:"=",postid:"=",poster:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"comments/commentsList.html",controller:n}}]);ngComments.factory("commentsService",["$http","$q","configProvider","dateHelper",function(n,t,i,r){var u=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi:i.getSettings().BlogApi;return{getCommentsByPost:function(i){var r=t.defer(),f=this;return n({url:u+"Posts/"+i+"/Comments",method:"GET"}).success(function(n){_.each(n,function(n){n=f.addViewProperties(n,!1,!1);_.each(n.Comments,function(n){f.addViewProperties(n)})});r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},getCommentsByUser:function(r){var e=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"user/":i.getSettings().BlogApi+"user/",u=t.defer(),f=this;return n({url:e+r+"/comments",method:"GET"}).success(function(n){_.each(n,function(n){n=f.addViewProperties(n,!1,!1);_.each(n.Comments,function(n){f.addViewProperties(n)})});u.resolve(n)}).error(function(n){u.reject(n)}),u.promise},likeComment:function(i,r){var f=t.defer();return n({url:u+"comments/likes?username="+r+"&commentId="+i,method:"POST"}).success(function(n){f.resolve(n)}).error(function(n){f.reject(n)}),f.promise},addComment:function(i){var r=t.defer();return n({url:u+"comments",method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},addViewProperties:function(n,t,i){return n.DateDisplay=r.getDateDisplay(n.CreatedDate),n.NameDisplay=n.User!=null?n.User.FirstName+" "+n.User.LastName:"",n.Url="/#/user/"+(n.User!=null?n.User.UserName:""),t!=undefined&&(n.ShowReplies=!1),i!=undefined&&(n.ShowAddReply=!1),n}}}]);ngConfig=angular.module("ngConfig",[]);ngConfig.provider("configProvider",[function(){var n={width:0,height:0,mode:""},t={BlogApi:"",BlogRoot:"",BlogSockets:"",BlogSocketsAvailable:!0,HubUrl:"",AlertTimer:5e3},f={POPULAR:"Popular",RECENT:"Recent",USEROWNED:"UserOwned"},i={profilePictureUrl:"",backgroundPictureUrl:""},r=[],u={};this.$get=[function(){return{getSettings:function(){return t},getNavigationItems:function(){return r},getDefaults:function(){return i},getSocketClientFunctions:function(){return u},getBlogSocketsAvailability:function(){return t.BlogSocketsAvailable},setDimensions:function(t,i){n.width=t;n.height=i;t>=320&&t<=767?n.mode="mobile":t>=768&&t<=1024?n.mode="tablet":t>1024&&(n.mode="desktop")},setSocketClientFunctions:function(n){u=n},setBlogApiEndpoint:function(n){t.BlogApi=n},setBlogRoot:function(n){t.BlogRoot=n},setBlogSockets:function(n){t.BlogSockets=n},setBlogSocketsAvailability:function(n){t.BlogSocketsAvailable=n},setDefaultProfilePicture:function(n){i.profilePictureUrl=n},setDefaultBackgroundPicture:function(n){i.backgroundPictureUrl=n},setNavigationItems:function(n){r=n},pageState:f,windowDimensions:n}}]}]);ngError=angular.module("ngError",["ngConfig","ngLogin"]);ngError.controller("errorPageController",["$scope","errorService","configProvider",function(n,t,i){n.errorImage=i.getSettings().BlogRoot+"/content/images/error-pages/servererror_bg2.png";n.error=t.getError()}]);ngError.directive("errorDisplay",[function(){var n=function(n,t){n.errorMessage="";n.$on("displayError",function(n,i){t.setError(i)})},t;return n.$inject=["$scope","errorService"],t=function(n,t){n.$on("displayError",function(i,r){n.errorMessage=r.Message!=undefined?r.Message:r;$(t).removeClass("hidden")});$("#blog-error-global .close-error").on("click",function(n){n.preventDefault();$(t).addClass("hidden")})},{restrict:"EA",scope:{data:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"error/errorDisplay.html",controller:n,link:t}}]);ngError.factory("errorService",["$location","$rootScope","$window","configProvider","authenticationService",function(n,t,i,r,u){var f={},e=function(n){return n.error=="invalid_grant"||n.Message=="Authorization has been denied for this request."?!1:!0},o=function(){u.logout().then(function(){i.location.href=r.getSettings().BlogRoot+"/account"},function(n){t.$broadcast("displayError",n)})};return{displayError:function(n){f=n;e(n)&&t.$broadcast("displayError",n)},displayErrorRedirect:function(t){f=t;e(t)?n.path("/error"):o()},highlightField:function(){return"field-error"},setError:function(n){f=n},getError:function(){return f}}}]);ngHeader=angular.module("ngHeader",["ngConfig","ngLogin"]);ngHeader.directive("headerMenu",function(){var n=function(n,t,i,r,u,f,e,o){n.userLoggedIn=!1;n.toggleClass="nav-close";n.goAddNewPost=function(){$("#blog-header-collapsible").collapse("hide");t.path("/post/create/new")};n.$on("toggleNavigation",function(n,t){r.toggle(t.direction,undefined)});n.testDisplayError=function(){$("#blog-header-collapsible").collapse("hide");i.$broadcast("displayError",{Message:"This is a test error message."})};n.getUserInfo=function(){$("#blog-header-collapsible").collapse("hide");o.getUserInfo().then(function(n){n.Message!=undefined||n.Message!=null?i.$broadcast("launchLoginForm",{canClose:!0}):i.$broadcast("displayError",{Message:JSON.stringify(n)})})};n.showLoginForm=function(){i.$broadcast("launchLoginForm",{canClose:!0})};n.logout=function(){o.logout();f.location.href=e.getSettings().BlogRoot+"/account"};n.toggleSocketDebugger=function(){i.$broadcast("toggleSocketDebugger")};r.getSnapper().then(function(t){var i=function(){n.toggleClass=n.toggleClass=="nav-open"?"nav-close":"nav-open";$("#blog-header-collapsible").collapse("hide")};t.on("open",function(){i()});t.on("close",function(){i()})})},t;return n.$inject=["$scope","$location","$rootScope","snapRemote","$http","$window","configProvider","authenticationService"],t=function(){},{link:t,restrict:"EA",scope:{data:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"header/headerMenu.html",controller:n}});ngLogger=angular.module("ngLogger",["ngConfig"]);ngLogger.factory("errorLogService",["$log","$window","configProvider","stacktraceService",function(n,t,i,r){function u(u,f){var s=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"log":i.getSettings().BlogApi+"log",e,o;n.error.apply(n,arguments);try{e=u.toString();o=r.print({e:u});$.ajax({type:"POST",url:s,contentType:"application/json",data:JSON.stringify({ErrorUrl:t.location.href,ErrorMessage:e,StackTrace:o,Cause:f||""}),success:function(t){n.error.apply(t)}})}catch(h){n.warn("Error logging failed");n.log(h)}}return u}]);ngLogger.factory("stacktraceService",[function(){return{print:printStackTrace}}]);ngLogin=angular.module("ngLogin",["ngRoute","ngConfig","LocalStorageModule","mgcrea.ngStrap"]);ngLogin.directive("loginForm",function(){var n=function(n,t,i,r,u,f,e,o,s){n.username="";n.password="";n.rememberMe=!1;n.errorMessage="";n.registerPopover={title:"Don't have an account?",content:"Create an account with Bloggity so you bloggity-bliggity-blog away!"};n.showErrorMessage=function(){return n.errorMessage==""?!1:!0};n.hasError=function(){return n.errorMessage==""?"":"has-error"};n.login=function(){s.login(n.username,n.password).then(function(i){i.error==undefined||i.error==null?n.isModal()?(t.$broadcast("hideLoginForm"),t.$broadcast("userLoggedIn",{username:n.username}),r.path("/")):u.location.href=o.getSettings().BlogRoot:n.errorMessage=i.error_description},function(t){n.errorMessage=t.Message})};n.isModal=function(){return n.modal==undefined?!1:n.modal?!0:!1}},t;return n.$inject=["$scope","$rootScope","$timeout","$location","$window","errorService","localStorageService","configProvider","authenticationService"],t=function(n,t){n.showRegisterForm=function(){$(t).closest(".modal-body").addClass("hover")}},{restrict:"EA",scope:{modal:"="},link:t,replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"login/loginform.html",controller:n}});ngLogin.directive("loginFormModal",function(){var n=function(n,t,i){n.loginModal=i({template:window.blogConfiguration.templatesModulesUrl+"login/loginformmodal.html",show:!1,keyboard:!1,backdrop:"static"});t.$on("launchLoginForm",function(t,i){try{if(n.loginModal.$options.show)return;i.canClose?(n.loginModal.$options.keyboard=!0,n.loginModal.$options.backdrop=!0):(n.loginModal.$options.keyboard=!1,n.loginModal.$options.backdrop="static");n.loginModal.$promise.then(n.loginModal.show)}catch(r){n.loginModal.$options.keyboard=!1;n.loginModal.$options.backdrop="static";n.loginModal.$promise.then(n.loginModal.show)}});t.$on("hideLoginForm",function(){n.loginModal.hide()})};return n.$inject=["$scope","$rootScope","$modal"],{restrict:"EA",scope:{data:"="},replace:!0,controller:n}});ngLogin.directive("registerForm",function(){var n=function(n,t,i,r,u,f,e,o){n.username="";n.password="";n.confirmPassword="";n.firstName="";n.lastName="";n.email="";n.birthDate="";n.errors=[];n.messageDisplay={show:!1,type:"alert-success",message:""};n.register=function(){o.blockIt({html:'<h4><img src="content/images/loader-girl.gif" height="128" /><\/h4>',css:{border:"none",padding:"5px",backgroundColor:"#000",opacity:.5,color:"#fff"}});var i={Username:n.username,Password:n.password,ConfirmPassword:n.confirmPassword,FirstName:n.firstName,LastName:n.lastName,Email:n.email,BirthDate:n.birthDate};e.saveRegistration(i).then(function(i){i.error==undefined||i.error==null?(o.unblockIt(),o.blockIt({html:'<div class="alert alert-success"><p>Hooray! You have successfully registered an account to Bloggity! Let\'s sign you in now.<\/p><\/div>',css:{border:"none",padding:"0",backgroundColor:"#000",color:"#fff"}}),e.login(n.username,n.password).then(function(u){u.error==undefined||u.error==null?n.isModal()?(t.$broadcast("hideLoginForm"),t.$broadcast("userLoggedIn")):r.location.href=f.getSettings().BlogRoot:n.showMessageDisplay("alert-warning","Oops! We've managed to create your account but there was a problem logging you in. ("+i.error_description+")");o.unblockIt()},function(t){n.showMessageDisplay("alert-warning","Oops! We've managed to create your account but there was a problem logging you in. ("+t.Message+")");o.unblockIt()})):(o.unblockIt(),n.showMessageDisplay("alert-danger",error.Message))},function(t){var i,r;try{for(i in t.ModelState)r={field:i==""?"username":i.split(".")[1].toLowerCase(),message:t.ModelState[i][0]},n.errors.push(r);o.unblockIt()}catch(u){o.unblockIt()}})};n.hasError=function(t){var i="";return _.each(n.errors,function(n){n.field==t&&(i="has-error",$(".login-form.register").find(".content input[name='"+n.field+"']").prev("p").text(n.message))}),i};n.showMessageDisplay=function(t,i){n.messageDisplay.type=t;n.messageDisplay.message=i;n.messageDisplay.show=!0};n.isModal=function(){return n.modal==undefined?!1:n.modal?!0:!1}},t;return n.$inject=["$scope","$rootScope","$timeout","$window","errorService","configProvider","authenticationService","blockUiService"],t=function(n,t){n.showLoginForm=function(){$(t).closest(".modal-body").removeClass("hover")}},{restrict:"EA",scope:{modal:"="},replace:!0,link:t,templateUrl:window.blogConfiguration.templatesModulesUrl+"login/registerform.html",controller:n}});ngLogin.factory("authenticationInterceptorService",["$q","$rootScope","$location","localStorageService",function(n,t,i,r){return{request:function(n){n.headers=n.headers||{};var t=r.get("authorizationData");return t&&(n.headers.Authorization="Bearer "+t.token),n},responseError:function(u){return u.status===401&&(i.path("/"),t.$broadcast("launchLoginForm",{canClose:!0}),r.remove("username"),r.remove("authorizationData")),n.reject(u)}}}]);ngLogin.factory("authenticationService",["$http","$q","configProvider","localStorageService",function(n,t,i,r){var f=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Account/":i.getSettings().BlogApi+"Account/",u={isAuthenticated:!1,username:""};return{saveRegistration:function(i){this.logout();var r=t.defer();return n({url:f+"register?trNsUm3GtEwsLe='allow'",method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},getUserInfo:function(){var i=t.defer();return n({url:f+"userinfo",method:"GET"}).success(function(n){i.resolve(n)}).error(function(n){i.reject(n)}),i.promise},getAuthenticationData:function(){return u},createAuthenticationData:function(){var n=r.get("authorizationData");n&&(u.isAuthenticated=!0,u.username=n.userName)},login:function(i,e){var o=t.defer(),s="grant_type=password&Username="+i+"&Password="+e;return n.post(f+"login",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){r.add("username",i);r.set("authorizationData",{token:n.access_token,username:i});u.isAuthenticated=!0;u.username=i;o.resolve(n)}).error(function(n){o.reject({Message:n.error_description})}),o.promise},logout:function(){r.remove("username");r.remove("authorizationData");u.isAuthenticated=!1;u.username=""}}}]);ngLogin.factory("loginService",["$http","$q","$window","configProvider",function(n,t,i,r){var u=r.getSettings().BlogRoot==""?window.blogConfiguration.blogRoot+"Authentication":r.getSettings().BlogRoot+"Authentication",f=r.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Authenticate":r.getSettings().BlogApi+"Authenticate";return{login:function(i,r,f){var e=t.defer(),o={Username:i,Password:r,RememberMe:f};return n({url:u+"/Login",method:"POST",data:o}).success(function(n){n.Session!=null&&n.User!=null?e.resolve(n):e.reject(n)}).error(function(){e.reject({Message:"Error communicating with login server!"})}),e.promise},logout:function(i){var r=t.defer(),f={Username:i};return n({url:u+"/Logout",method:"POST",data:f}).success(function(n){n==null||n==""?r.resolve(n):r.reject(n)}).error(function(){r.reject({Message:"Error communicating with login server!"})}),r.promise},loginApi:function(i,r,u){var e=t.defer(),o={Username:i,Password:r,RememberMe:u};return n({url:f,method:"POST",data:o}).success(function(n){e.resolve(n)}).error(function(){e.reject({Message:"Error authenticating in the API!"})}),e.promise},logoutApi:function(i){var r=t.defer(),u={Username:i};return n({url:f,method:"PUT",data:u}).success(function(n){r.resolve(n)}).error(function(){r.reject({Message:"Error logging out in the API!"})}),r.promise}}}]);blog=angular.module("blog",["ngRoute","ngAnimate","ngCookies","mgcrea.ngStrap","snap","ngConfig","ngLogger","ngHeader","ngLogin","ngPosts","ngComments","ngError","ngNavigation","ngUser","ngTags","ui.router"]);blog.run(["$rootScope","$state","$stateParams",function(n,t,i){n.$state=t;n.$stateParams=i}]);blog.config(["$routeProvider","$httpProvider","$provide","$stateProvider","$urlRouterProvider",function(n,t,i,r,u){i.factory("httpInterceptor",["$q","$location","blockUiService",function(n,t,i){return{request:function(t){return i.blockIt(),t||n.when(t)},requestError:function(t){return i.blockIt(),n.reject(t)},response:function(t){return i.unblockIt(),t||n.when(t)},responseError:function(t){return i.unblockIt(),n.reject(t)}}}]);t.interceptors.push("httpInterceptor");t.interceptors.push("authenticationInterceptorService");u.otherwise("/");r.state("posts",{url:"/",templateUrl:window.blogConfiguration.templatesUrl+"posts.html",controller:"postsController"}).state("viewpost",{url:"/post/:postId",templateUrl:window.blogConfiguration.templatesUrl+"viewpost.html",controller:"postsViewController"}).state("friends",{url:"/friends",templateUrl:window.blogConfiguration.templatesUrl+"friends.html"}).state("groups",{url:"/groups",templateUrl:window.blogConfiguration.templatesUrl+"groups.html"}).state("events",{url:"/events",templateUrl:window.blogConfiguration.templatesUrl+"events.html"}).state("newpost",{url:"/post/create/new",templateUrl:window.blogConfiguration.templatesUrl+"modifypost.html",controller:"postsModifyController"}).state("editpost",{url:"/post/edit/:postId",templateUrl:window.blogConfiguration.templatesUrl+"modifypost.html",controller:"postsModifyController"}).state("ownprofile",{url:"/user",templateUrl:window.blogConfiguration.templatesUrl+"user.html",controller:"userProfileController",abstract:!0}).state("ownprofile.details",{url:"",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofiledetails.html",controller:"userProfileController"}).state("ownprofile.posts",{url:"/posts",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofileposts.html",controller:"userProfilePostsController"}).state("ownprofile.comments",{url:"/comments",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilecomments.html",controller:"userProfileCommentsController"}).state("ownprofile.media",{url:"/media",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilemedia.html",controller:"userProfileMediaController"}).state("ownprofile.favorites",{url:"/favorites",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilefavorites.html",controller:"userProfileFavoritesController"}).state("othersprofile",{url:"/user/:username",templateUrl:window.blogConfiguration.templatesUrl+"user.html",controller:"userProfileController",abstract:!0}).state("othersprofile.details",{url:"",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofiledetails.html",controller:"userProfileController"}).state("othersprofile.posts",{url:"/posts",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofileposts.html",controller:"userProfilePostsController"}).state("othersprofile.comments",{url:"/comments",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilecomments.html",controller:"userProfileCommentsController"}).state("othersprofile.media",{url:"/media",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilemedia.html",controller:"userProfileMediaController"}).state("othersprofile.favorites",{url:"/favorites",templateUrl:window.blogConfiguration.templatesUrl+"modules/user/userprofilefavorites.html",controller:"userProfileFavoritesController"}).state("error",{url:"/error",templateUrl:window.blogConfiguration.templatesUrl+"errorpage.html",controller:"errorPageController"})}]);blog.controller("blogMainController",["$scope","$location","$rootScope","$log","$timeout","localStorageService","userService","authenticationService",function(n,t,i,r,u,f,e,o){n.authData=f.get("authorizationData");n.username=null;i.$on("$locationChangeStart",function(n,t,u){r.info("location changing from "+u+" to "+t);i.user&&i.$broadcast("loggedInUserInfo",i.user)});n.init=function(){n.authData!=null?(n.username=f.get("username"),o.getUserInfo().then(function(t){(t.Message==undefined||t.Message==null)&&n.getUserInfo(n.username)},function(){o.logout()})):o.logout()};n.getUserInfo=function(t){e.getUserInfo(t).then(function(t){t.Error==null&&(i.user=t,i.authData=n.authData,u(function(){i.$broadcast("loggedInUserInfo",t)},1500))})};i.$on("userLoggedIn",function(t,i){n.getUserInfo(i.username)});n.init()}]);blog.directive("windowResize",["$window","$rootScope","$timeout",function(n,t,i){return{restrict:"EA",link:function(r){r.onResizeFunction=function(){r.windowHeight=n.innerHeight;r.windowWidth=n.innerWidth;t.$broadcast("windowSizeChanged",{height:r.windowHeight,width:r.windowWidth})};r.onResizeFunction();angular.element(n).bind("resize",function(){i(function(){r.onResizeFunction();r.$apply()},500)})}}}]);ngMedia=angular.module("ngMedia",["ngShared","iso.directives"]);ngMedia.directive("albumGroup",function(){var n=function(n,t,i,r,u){var f=u({title:"Delete?",content:"Are you sure you want to delete this album? Doing so will also delete all the media in it.",scope:n,template:window.blogConfiguration.templatesModulesUrl+"media/mediaDeleteDialog.html",show:!1}),e,o;n.isExpanded=!0;n.newAlbumName="";n.toggleExpandClass=function(){return n.isExpanded?"fa-minus":"fa-plus"};n.toggleExpanded=function(){n.isExpanded=!n.isExpanded};n.editAlbum=function(){n.album.IsEditing=!0};n.cancelEditAlbum=function(){n.album.IsNew&&(n.$emit("cancelledAddingOfAlbum",n.album),n.album.IsEditing=!1);n.album.IsEditing=!1};n.saveAlbum=function(){var i={IsUserDefault:!1,AlbumName:n.album.AlbumName,AlbumId:n.album.AlbumId?n.album.AlbumId:0};t.authData&&(i.User=t.user);n.album.IsNew?e(i):o(i)};n.deleteAlbum=function(){f.$promise.then(f.show)};n.confirmDelete=function(){i.deleteAlbum(n.album.AlbumId).then(function(t){if(f.hide(),t.Error!=null){r.displayError(t.Error);return}n.$emit("successDeletingAlbum",n.album)},function(t){n.setModelStateErrors(t.ModelState);f.hide()})};e=function(t){i.addAlbum(t).then(function(t){if(t.Error!=null){r.displayError(t.Error);return}t.IsEdit=!1;t.IsNew=!1;n.album=t},function(n){r.displayError(n)})};o=function(t){i.updateAlbum(t).then(function(t){if(t.Error!=null){r.displayError(t.Error);return}t.IsEdit=!1;t.IsNew=!1;n.album=t},function(n){r.displayError(n)})}};return n.$inject=["$scope","$rootScope","albumService","errorService","$modal"],{restrict:"EA",scope:{album:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"media/albumGroup.html",controller:n}});ngMedia.directive("mediaGroupedList",function(){var n=function(n){n.isAdding=!1;n.addAlbum=function(){n.albums.push({AlbumName:"",IsNew:!0,IsEditing:!0});n.isAdding=!0};n.$on("cancelledAddingOfAlbum",function(t,i){var r=n.albums.indexOf(i);n.albums.splice(r,1);n.isAdding=!1});n.$on("successDeletingAlbum",function(t,i){var r=n.albums.indexOf(i);n.albums.splice(r,1)})};return n.$inject=["$scope","$rootScope","albumService","localStorageService"],{restrict:"EA",scope:{albums:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"media/mediaGroupedList.html",controller:n}});ngMedia.directive("mediaItem",function(){var n=function(n,t,i,r,u,f){var e=r({title:"Delete?",content:"Are you sure you want to delete this item?",scope:n,template:window.blogConfiguration.templatesModulesUrl+"media/mediaDeleteDialog.html",show:!1});n.username=i.get("username");n.deleteButtonVisible=!1;n.viewMode=function(){return n.mode&&n.mode==="thumbnail"?"thumbnail":""};n.getThumbnailUrl=function(){return n.crop&&n.crop==="true"?n.media?{"background-image":"url("+n.media.ThumbnailUrl+")"}:{"background-image":"url(/content/images/warning.png)"}:{}};n.toggleDelete=function(){return n.allowDelete&&n.allowDelete==="true"&&t.authData&&n.user&&n.username===n.user.UserName?!0:!1};n.deleteMedia=function(){e.$promise.then(e.show)};n.confirmDelete=function(){u.deleteMedia(n.media.Id).then(function(t){if(e.hide(),t.Error!=null){f.displayError(t.Error);return}n.$emit("successDeletingMedia",n.media)},function(t){n.setModelStateErrors(t.ModelState);e.hide()})};n.getContentType=function(n){if(n==undefined)return"image";var t=n.split("/");return t[0]=="video"?"video":"image"}},t;return n.$inject=["$scope","$rootScope","localStorageService","$modal","mediaService","errorService"],t=function(n,t,i){n.mode=i.mode;n.crop=i.crop;n.allowDelete=i.allowDelete;n.isCropped=function(){return i.crop&&i.crop==="true"?"center-cropped":""}},{restrict:"EA",scope:{media:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"media/mediaItem.html",controller:n,link:t}});ngMedia.factory("albumService",["$http","$q","configProvider","dateHelper",function(n,t,i,r){var u=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi:i.getSettings().BlogApi;return{getAlbumsByUser:function(i){var f=t.defer();return n({url:u+"users/"+i+"/albums",method:"GET"}).success(function(n){_.each(n,function(n){n.CreatedDateDisplay=r.getDateDisplay(n.CreatedDate);n.IsNew=!1;n.IsEditing=!1;_.each(n.Media,function(n){n.CreatedDateDisplay=r.getDateDisplay(n.CreatedDate)})});f.resolve(n)}).error(function(n){f.reject(n)}),f.promise},getUserDefaultAlbum:function(i){var r=t.defer();return n({url:u+"users/"+i+"/albums/default",method:"GET"}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},addAlbum:function(i){var r=t.defer();return n({url:u+"album",method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},updateAlbum:function(i){var r=t.defer();return n({url:u+"album",method:"PUT",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},deleteAlbum:function(i){var r=t.defer();return n({url:u+"album/"+i,method:"DELETE"}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise}}}]);ngMedia.factory("mediaService",["$http","$q","configProvider",function(n,t,i){var r=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi:i.getSettings().BlogApi;return{getMediaByAlbum:function(i){var u=t.defer();return n({url:r+"album/"+i+"/media",method:"GET"}).success(function(n){u.resolve(n)}).error(function(n){u.reject(n)}),u.promise},getMediaByUser:function(i){var u=t.defer();return n({url:r+"users/"+i+"/media",method:"GET"}).success(function(n){u.resolve(n)}).error(function(n){u.reject(n)}),u.promise},addMedia:function(i,u,f){var e=t.defer();return n({url:r+"media?username="+f+"&album="+u,method:"POST",data:comment}).success(function(n){e.resolve(n)}).error(function(n){e.reject(n)}),e.promise},deleteMedia:function(i){var u=t.defer();return n({url:r+"media/"+i,method:"DELETE"}).success(function(n){u.resolve(n)}).error(function(n){u.reject(n)}),u.promise}}}]);ngMessaging=angular.module("ngMessaging",["ngConfig"]);ngNavigation=angular.module("ngNavigation",["ngConfig"]);ngNavigation.directive("navigationMenu",function(){var n=function(n,t,i,r,u,f,e){n.navigationItems=u.getNavigationItems();n.user={};n.authData=f.get("authorizationData");n.isLoggedIn=function(){return n.authData?!0:!1};n.logout=function(){e.logout();i.location.href=u.getSettings().BlogRoot+"/account"};n.launchLoginForm=function(){t.$broadcast("launchLoginForm",{canClose:!0})};n.toggleNavigation=function(){t.$broadcast("toggleNavigation",{direction:"left"})};t.$watch("user",function(){t.user&&(n.user=t.user,n.user.FullName=n.user.FirstName+" "+n.user.LastName)});t.$on("userLoggedIn",function(){n.authData=f.get("authorizationData")})};return n.$inject=["$scope","$rootScope","$window","userService","configProvider","localStorageService","authenticationService"],{restrict:"EA",scope:{data:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"navigation/navigationMenu.html",controller:n}});ngPosts=angular.module("ngPosts",["ngSanitize","ngComments","ngTags","ngUser","ngError","ngMedia","ngBlogSockets","ngCkeditor","ngTagsInput","iso.directives","ngConfig","LocalStorageModule","angularFileUpload","angular-carousel"]);ngPosts.controller("postsController",["$scope","$rootScope","$location","$timeout","$interval","localStorageService","postsService","errorService",function(n,t,i,r,u,f,e,o){n.posts=[];n.size="";n.isBusy=!1;n.init=function(){n.getRecentPosts();t.$broadcast("updateScrollTriggerWatch","posts-main")};n.getRecentPosts=function(){n.isBusy||(n.isBusy=!0,e.getRecentPosts().then(function(t){n.posts=t;n.isBusy=!1;n.$broadcast("resizeIsotopeItems")},function(n){o.displayError(n)}))};n.getMoreRecentPosts=function(){n.isBusy||(n.isBusy=!0,e.getMoreRecentPosts(n.posts.length).then(function(t){_.each(t,function(t){n.posts.push(t)});n.isBusy=!1;n.$broadcast("resizeIsotopeItems")},function(n){o.displayError(n)}))};n.$on("updatePostsSize",function(t,i){n.size=i});n.$on("scrollBottom",function(){n.getMoreRecentPosts()});n.init()}]);ngPosts.controller("postsModifyController",["$scope","$rootScope","$location","$timeout","$window","FileUploader","localStorageService","postsService","userService","tagsService","errorService","dateHelper","configProvider","authenticationService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){n.isAdding=!0;n.existingContents=[];n.username=e.get("username");n.authData=e.get("authorizationData");n.dimensionMode=a.windowDimensions.mode==""?window.getDimensionMode():a.windowDimensions.mode;n.post={PostTitle:"",PostMessage:"",PostContents:[],Tags:[]};n.uploadUrl=a.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"media?username="+n.username+"&album=default":a.getSettings().BlogApi+"media?username="+n.username+"&album=default";n.onTagAdded=function(t){var i={TagName:t.text};n.post.Tags.push(i)};n.onTagRemoved=function(t){var i={TagName:t.text},r=n.post.Tags.indexOf(i);n.post.Tags.splice(r)};n.getTagsSource=function(n){return h.getTagsByName(n)};n.getPost=function(){o.getPost(t.$stateParams.postId).then(function(t){n.username===t.User.UserName?t.Error==undefined?(n.isAdding=!1,n.post=t,_.each(t.Tags,function(t){n.Tags.push({text:t.TagName})}),_.each(t.PostContents,function(t){var i={file:{name:t.Media.FileName,size:1e6},mediaId:t.Media.MediaId,progress:100,isUploaded:!0,isSuccess:!0,isExisting:!0,url:t.Media.ThumbnailUrl,base:t,remove:function(){var t=n.post.PostContents.indexOf(this.base);n.post.PostContents.splice(t);y.removeFromQueue(this)}};n.existingContents.push(i)}),r(function(){_.each(n.existingContents,function(n){y.queue.push(n)});n.$broadcast("resizeIsotopeItems")},500)):c.displayError(t.Error):c.displayError({Message:"Oh you sneaky bastard! This post is not yours to edit."})},function(n){c.displayError(n)})};n.savePost=function(){n.authData?s.getUserInfo(n.username).then(function(t){n.post.User=t;n.isAdding?o.addPost(n.post).then(function(n){n.Error==undefined?i.path("/"):c.displayError(n.Error)},function(n){c.displayError(n)}):o.updatePost(n.post).then(function(n){n.Error==undefined?i.path("/"):c.displayError(n.Error)},function(n){c.displayError(n)})},function(n){c.displayError(n)}):t.$broadcast("launchLoginForm")};n.cancelPost=function(){i.path("/")};n.init=function(){v.getUserInfo().then(function(i){i.Message==undefined||i.Message==null?isNaN(t.$stateParams.postId)||n.getPost():c.displayErrorRedirect(i.Message)})};t.$watch("user",function(){n.user=t.user;n.username=n.user.UserName;n.uploadUrl=a.getSettings().BlogApi+"media?username="+n.username+"&album=default"});n.$on("userLoggedIn",function(){n.username=e.get("username");n.authData=e.get("authorizationData")});n.$on("windowSizeChanged",function(n,t){a.setDimensions(t.width,t.height)});var y=n.uploader=new f({scope:t,url:n.uploadUrl,headers:{Authorization:"Bearer "+(n.authData?n.authData.token:"")}});y.filters.push({name:"imageFilter",fn:function(n){var t=y.isHTML5?n.type:"/"+n.value.slice(n.value.lastIndexOf(".")+1);return t="|"+t.toLowerCase().slice(t.lastIndexOf("/")+1)+"|","|jpg|png|jpeg|bmp|gif|mp4|flv|webm|".indexOf(t)!==-1}});y.onSuccessItem=function(t,i){t.mediaId=i.MediaId;var r={PostId:0,Media:i,PostContentTitle:t.postContentTitle,PostContentText:t.postContentText};n.post.PostContents.push(r)};y.onAfterAddingFile=function(n){n.allowCaptions=!0;n.postContentTitle="";n.postContentText=""};y.onAfterAddingAll=function(){};n.init()}]);ngPosts.controller("postsViewController",["$scope","$rootScope","$location","postsService","userService","configProvider","errorService","localStorageService",function(n,t,i,r,u,f,o,s){n.postId=parseInt(t.$stateParams.postId);n.post={};n.user={};n.postsList=[];n.isBusy=!1;n.authData=s.get("authorizationData");n.init=function(){if(!n.isBusy){if(n.isBusy=!0,n.authData){var t=s.get("username");u.getUserInfo(t).then(function(t){n.user=t},function(n){o.displayError({Message:n})})}n.getViewedPost()}};n.getContentType=function(n){if(n==undefined)return"image";var t=n.split("/");return t[0]=="video"?"video":"image"};n.getPostsList=function(){r.getPopularPosts().then(function(t){n.postsList=t},function(n){o.displayError({Message:n})})};n.getViewedPost=function(){isNaN(t.$stateParams.postId)?o.displayErrorRedirect({Message:"You're missing the post to edit bruh! Don't be stupid!"}):r.getPost(n.postId).then(function(t){t.Error==undefined?(n.post=t,n.isBusy=!1,n.$broadcast("viewedPostLoaded",{PostId:n.post.Id,PostLikes:n.post.PostLikes}),n.$broadcast("resizeIsotopeItems"),r.subscribeToPost(n.post.Id)):o.displayError({Message:e})},function(n){o.displayError({Message:n})})};t.$on(f.getSocketClientFunctions().wsConnect,function(){r.subscribeToPost(n.post.Id)});n.init()}]);ngPosts.directive("postContents",function(){var n=function(){};return n.$inject=["$scope"],{restrict:"EA",scope:{contents:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postContents.html",controller:n}});ngPosts.directive("postLikes",[function(){var t=function(n,t){n.highlight=function(){$(t).effect("highlight",{color:"#B3C833"},1500)}},n=function(n,t,i,r,u,f,e){n.postId=n.data.PostId;n.postLikes=n.data.PostLikes;n.user=null;n.username=f.get("username");n.authData=f.get("authorizationData");n.tooltip={title:"Click to favorite this post."};n.$on(e.getSocketClientFunctions().postLikesUpdate,function(t,i){i.postId==n.data.PostId&&(n.postLikes=i.postLikes,n.$apply(),n.highlight(),n.isUserLiked())});n.$on("loggedInUserInfo",function(t,i){n.user=i;n.isUserLiked()});t.$watch("user",function(){n.user=t.user;n.isUserLiked()});n.$on("viewedPostLoaded",function(t,i){n.postId=i.PostId;n.postLikes=i.PostLikes;n.isUserLiked()});n.likePost=function(){i.likePost(n.data.PostId,n.username).then(function(){},function(n){u.displayError(n)})};n.isUserLiked=function(){var t=!1;return n.authData&&n.user&&_.each(n.postLikes,function(i){i.UserId==n.user.Id&&(t=!0)}),t?"fa-star":"fa-star-o"}};return n.$inject=["$scope","$rootScope","postsService","userService","errorService","localStorageService","configProvider"],{restrict:"EA",scope:{data:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postlikes.html",controller:n,link:t}}]);ngPosts.directive("postListItem",[function(){var n=function(n,t,i){n.post=n.data.Post;n.user=n.data.Post.User;n.username=i.get("username");n.hasComments=n.data.Post.Comments.length>0?!0:!1;n.hasTags=n.data.Post.Tags.length>0?!0:!1;n.getCommentPopover=function(t){var i=_.where(n.comments,{CommentId:t}),r=i.User.FirstName+" "+i.User.LastName;return{title:r,content:i.CommentMessage}};n.getPostSize=function(){return n.data.Width};n.isEditable=function(){return n.user.UserName===n.username?!0:!1};n.editPost=function(){t.path("/post/edit/"+n.post.Id)}};return n.$inject=["$scope","$location","localStorageService"],{restrict:"EA",scope:{data:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postListItem.html",controller:n}}]);ngPosts.directive("postListItemComment",[function(){var n=function(n){n.user={name:n.comment.User.FirstName+" "+n.comment.User.LastName,url:"#"};n.popover={title:n.user.name,content:n.comment.CommentMessage}};return n.$inject=["$scope"],{restrict:"EA",scope:{comment:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postListItemComment.html",controller:n}}]);ngPosts.directive("postRelatedItem",[function(){return{restrict:"EA",scope:{post:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postrelateditem.html"}}]);ngPosts.directive("postRelatedItems",[function(){var n=function(n,t,i,r){n.hasError=!1;n.postsByTag=[];n.postsByUser=[];n.relatedCategories=[{name:"By user",id:"user"},{name:"By similar tags",id:"tags"}];n.selectedCategory=n.relatedCategories[0];n.emptyPostsMessage="There are no related posts.";n.getRelatedPosts=function(){isNaN(n.parentpostid)?n.hasError=!0:i.getRelatedPosts(n.parentpostid).then(function(t){n.hasError=!1;n.postsByTag=t.PostsByTags;n.postsByUser=t.PostsByUser},function(t){r.displayError(t);n.hasError=!0})};n.displayEmptyPostsMessage=function(){return n.selectedCategory.id=="user"?n.postsByUser.length>0?!1:!0:n.postsByTag.length>0?!1:!0};n.emptyPostsStyle=function(){return n.hasError?"alert-danger":"alert-warning"};n.getEmptyPostsMessage=function(){return n.hasError?"Something went wrong with loading the related posts! :(":"There are no related posts yet."};n.displayUser=function(){return n.selectedCategory.id=="user"?n.postsByUser.length>0?!0:!1:!1};n.displayTag=function(){return n.selectedCategory.id=="tags"?n.postsByTag.length>0?!0:!1:!1};n.getRelatedPosts()};return n.$inject=["$scope","$rootScope","postsService","errorService"],{restrict:"EA",scope:{parentpostid:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"posts/postrelateditems.html",controller:n}}]);ngPosts.factory("postsService",["$http","$q","blogSocketsService","configProvider","dateHelper",function(n,t,i,r,u){var f=r.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Posts/":r.getSettings().BlogApi+"Posts/",e=function(n){return n.DateDisplay=u.getDateDisplay(n.CreatedDate),n.Url="/#/post/"+n.Id,n};return{getPost:function(i){var r=t.defer();return n({url:f+i,method:"GET"}).success(function(n){var t=e(n);r.resolve(t)}).error(function(n){r.reject(n)}),r.promise},getRelatedPosts:function(i){var r=t.defer();return n({url:f+i+"/related",method:"GET"}).success(function(n){_.each(n.PostsByUser,function(n){e(n)});_.each(n.PostsByTags,function(n){e(n)});r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},getPopularPosts:function(){var i=t.defer();return n({url:f+"popular",method:"GET"}).success(function(n){_.each(n,function(n){e(n)});i.resolve(n)}).error(function(n){i.reject(n)}),i.promise},getRecentPosts:function(){var i=t.defer();return n({url:f+"recent",method:"GET"}).success(function(n){_.each(n,function(n){e(n)});i.resolve(n)}).error(function(n){i.reject(n)}),i.promise},getMoreRecentPosts:function(i){var r=t.defer();return n({url:f+"recent/more/"+i,method:"GET"}).success(function(n){_.each(n,function(n){e(n)});r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},getPostsByUser:function(i){var f=r.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"user/":r.getSettings().BlogApi+"user/",u=t.defer();return n({url:f+i+"/posts",method:"GET"}).success(function(n){_.each(n,function(n){e(n)});u.resolve(n)}).error(function(n){u.reject(n)}),u.promise},getMorePostsByUser:function(i,u){var o=r.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"user/":r.getSettings().BlogApi+"user/",f=t.defer();return n({url:o+i+"/posts/more/"+u,method:"GET"}).success(function(n){_.each(n,function(n){e(n)});f.resolve(n)}).error(function(n){f.reject(n)}),f.promise},subscribeToPost:function(n){i.emit(r.getSocketClientFunctions().unsubscribeViewPost,{postId:n});i.emit(r.getSocketClientFunctions().subscribeViewPost,{postId:n})},addPost:function(i){var r=t.defer();return n({url:f,method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},updatePost:function(i){var r=t.defer();return n({url:f,method:"PUT",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},likePost:function(i,r){var u=t.defer();return n({url:f+"likes?username="+r+"&postId="+i,method:"POST"}).success(function(n){u.resolve(n)}).error(function(n){u.reject(n)}),u.promise}}}]);ngShared=angular.module("ngShared",["angularFileUpload","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.buffering","com.2fdevs.videogular.plugins.poster","com.2fdevs.videogular.plugins.imaads"]);ngShared.directive("ellipsis",[function(){var n;return n=function(n,t,i){n.$on("reapplyEllipsis",function(){n.applyEllipsis()});n.applyEllipsis=function(){var n=parseInt(i.wrapHeight==undefined?180:i.wrapHeight);$(t).dotdotdot({ellipsis:"...",height:n})};n.applyEllipsis()},{restrict:"EA",link:n}}]);ngShared.directive("emptyRecordMessage",[function(){var n=function(){};return n.$inject=["$scope"],{restrict:"EA",scope:{message:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"shared/emptyRecordMessage.html",controller:n}}]);ngShared.directive("fileUpload",[function(){return{restrict:"EA",scope:{uploader:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"shared/fileUpload.html"}}]);ngShared.directive("fileUploadItem",[function(){var n=function(n){n.isNewContent=function(n){var t=!0;return n&&(t=!1),t}};return{link:n,restrict:"EA",scope:{item:"=",uploader:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"shared/fileUploadItem.html"}}]);ngShared.directive("fileUploadThumbnail",["$window","$rootScope","blockUiService",function(n,t,i){var r={support:!!(n.FileReader&&n.CanvasRenderingContext2D),isFile:function(t){return angular.isObject(t)&&t instanceof n.File},isImage:function(n){var t="|"+n.type.slice(n.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(t)!==-1}};return{restrict:"A",template:"<canvas/>",link:function(n,u,f){function h(n){var t=new Image;t.onload=c;t.src=n.target.result}function c(){i.blockIt();var n=e.width||this.width/this.height*e.height,r=e.height||this.height/this.width*e.width;o.attr({width:n,height:r});o[0].getContext("2d").drawImage(this,0,0,n,r);t.$broadcast("resizeIsotopeItems",{});i.unblockIt()}var e,o,s;r.support&&(e=n.$eval(f.fileUploadThumbnail),r.isFile(e.file))&&r.isImage(e.file)&&(o=u.find("canvas"),s=new FileReader,s.onload=h,s.readAsDataURL(e.file))}}}]);ngShared.directive("isotopeItemResize",["$window","$timeout","$interval",function(n,t){var i=function(i,r,u){i.columnCount=0;i.$emit("iso-option",{animationEngine:"best-available"});i.applyLayout=function(){t(function(){var u,t;for(e(n.innerWidth),i.$broadcast("iso-method",{name:null,params:null}),u=r.children(".isotope-item"),t=0;t<u.length;t++)(t+1)%i.columnCount==0&&$(u[t]).css({"margin-right":"0"})},1500)};i.$on("windowSizeChanged",function(n,t){(u.resizeLayoutOnly==undefined||u.resizeLayoutOnly==="false")&&e(t.width);i.applyLayout()});i.$on("resizeIsotopeItems",function(){i.applyLayout()});var f=function(n,t,i){var r=t==undefined?parseFloat(i):parseFloat(t),u=n/100*r;return parseInt(n/u)},e=function(n){if(u.resizeContainer==undefined)n>=992?(i.columnCount=f(n,u.resizeLarge,"32%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeLarge==undefined?"32%":u.resizeLarge;$(n).width(t)})):n>=767&&n<992?(i.columnCount=f(n,u.resizeLarge,"48%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeMedium==undefined?"48%":u.resizeMedium;$(n).width(t)})):(i.columnCount=f(n,u.resizeSmall,"96%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeSmall==undefined?"96%":u.resizeSmall;$(n).width(t)}));else{var e=$("#"+u.resizeContainer),t=e.outerWidth();t>1200?(i.columnCount=f(t,u.resizeXlarge,"19%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeXlarge==undefined?"19%":u.resizeXlarge;$(n).width(t)}),u.resizeBroadcast!=undefined&&i.$emit(u.resizeBroadcast,"xlarge")):t>992?(i.columnCount=f(t,u.resizeLarge,"24%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeLarge==undefined?"24%":u.resizeLarge;$(n).width(t)}),u.resizeBroadcast!=undefined&&i.$emit(u.resizeBroadcast,"large")):t>768?(i.columnCount=f(t,u.resizeMedium,"31.5%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeMedium==undefined?"31.5%":u.resizeMedium;$(n).width(t)}),u.resizeBroadcast!=undefined&&i.$emit(u.resizeBroadcast,"medium")):t>568?(i.columnCount=f(t,u.resizeSmall,"48%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeSmall==undefined?"48%":u.resizeSmall;$(n).width(t)}),u.resizeBroadcast!=undefined&&i.$emit(u.resizeBroadcast,"small")):(i.columnCount=f(t,u.resizeXsmall,"98%"),_.each($(r).children(".isotope-item"),function(n){var t=u.resizeXsmall==undefined?"98%":u.resizeXsmall;$(n).width(t)}),u.resizeBroadcast!=undefined&&i.$emit(u.resizeBroadcast,"xsmall"))}};i.applyLayout()};return{restrict:"EA",link:i}}]);ngShared.directive("ngEnter",function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.$apply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}});ngShared.directive("scrollTrigger",["$rootScope",function(n){return{link:function(t,i){t.scrollTriggerWatch=null;n.$on("updateScrollTriggerWatch",function(n,i){t.scrollTriggerWatch="#"+i});angular.element(i).bind("scroll",function(){if(t.scrollTriggerWatch!=null){var r=$(i).scrollTop();r+$(window).height()>=$(t.scrollTriggerWatch).outerHeight()&&n.$broadcast("scrollBottom")}})}}}]);ngShared.directive("ticker",function(){var n;return n=function(n,t,i){var r=$(t).newsTicker({row_height:80,max_rows:1,duration:5e3});if(i.enablePause)$(t).on("click",$(t).find("[data-pause-trigger]"),function(){r.newsTicker("toggle")})},{restrict:"EA",link:n}});ngShared.directive("videoPlayer",[function(){var n=function(n,t){n.currentTime=0;n.totalTime=0;n.state=null;n.volume=1;n.isCompleted=!1;n.API=null;n.onPlayerReady=function(t){n.API=t};n.onCompleteVideo=function(){n.currentTime=0;n.isCompleted=!0};n.onUpdateState=function(t){n.state=t};n.onUpdateTime=function(t,i){n.currentTime=t;n.totalTime=i};n.onUpdateVolume=function(t){n.volume=t};n.onUpdateSize=function(t,i){n.config.width=t;n.config.height=i};n.stretchModes=[{label:"None",value:"none"},{label:"Fit",value:"fit"},{label:"Fill",value:"fill"}];n.config={width:740,height:380,autoHide:!1,autoHideTime:3e3,autoPlay:!1,responsive:!1,stretch:n.stretchModes[2],sources:[{src:t.trustAsResourceUrl(n.media.MediaUrl),type:n.media.MediaType}],transclude:!0,theme:{url:window.blogConfiguration.blogRoot+"/content/plugins/videogular/themes/default/videogular.css"},plugins:{poster:{url:n.media.ThumbnailUrl}}}};return n.$inject=["$scope","$sce"],{restrict:"EA",scope:{media:"="},controller:n,replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"shared/videoPlayer.html"}}]);ngShared.factory("blockUiService",[function(){return{blockIt:function(n){n==undefined&&(n={});n.html==undefined&&(n.html='<h4><img src="content/images/loader-girl.gif" height="128" /><\/h4>');n.css==undefined&&(n.css={border:"none",padding:"5px",backgroundColor:"#000",opacity:.5,color:"#fff"});n.elem==undefined?$.blockUI({message:n.html,css:n.css}):$(n.elem).block({message:n.html,css:n.css})},unblockIt:function(n){n==undefined?$.unblockUI():$(n).unblock()}}}]);ngShared.factory("dateHelper",[function(){return{getJsFullDate:function(n){return moment(n)},getJsDate:function(n){return moment(n).format("MMM D, YYYY")},getMonthYear:function(n){return moment(n).format("MMMM YYYY")},getJsTime:function(n){return moment(n).format("hh:mm A")},getDateDisplay:function(n){var t=moment(n),i=moment();return t.from(i)+" at "+this.getJsTime(n)}}}]);ngBlogSockets=angular.module("ngBlogSockets",["ngConfig","ngAnimate"]);ngBlogSockets.directive("socketDebugger",[function(){var n=function(n,t,i,r){n.messages=[];n.show=!1;n.channelSubscription=null;n.echoMessage=null;n.showEmptyMessage=function(){return n.messages.length>0?!1:!0};n.doEcho=function(){i.emit("echo",{message:n.echoMessage})};n.subscribeToChannel=function(){var t=parseInt(n.channelSubscription);i.emit(r.getSocketClientFunctions().subscribeViewPost,{postId:t})};t.$on("toggleSocketDebugger",function(){n.show=!n.show});t.$on(r.getSocketClientFunctions().publishMessage,function(t,i){n.addToMessages(r.getSocketClientFunctions().publishMessage,i)});t.$on(r.getSocketClientFunctions().commentLikesUpdate,function(t,i){n.addToMessages(r.getSocketClientFunctions().commentLikesUpdate,i)});t.$on(r.getSocketClientFunctions().commentAdded,function(t,i){n.addToMessages(r.getSocketClientFunctions().commentAdded,i)});t.$on(r.getSocketClientFunctions().postLikesUpdate,function(t,i){n.addToMessages(r.getSocketClientFunctions().postLikesUpdate,i)});n.addToMessages=function(t,i){var r={fn:t,data:JSON.stringify(i)};n.messages.push(r);console.log(r)}};return n.$inject=["$scope","$rootScope","blogSocketsService","configProvider"],{controller:n,restrict:"EA",replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"sockets/socketDebugger.html"}}]);ngBlogSockets.factory("blogSocketsService",["$rootScope","configProvider",function(n,t){var r=t.getSettings().BlogSockets,u={resource:r+"socket.io"},i={};if(typeof io!="undefined"&&(i=io.connect(r,u)),t.getSettings().BlogSocketsAvailable==="true"){i.on("connect",function(){n.$broadcast(t.getSocketClientFunctions().wsConnect)});i.on("echo",function(n){console.log(n)});i.on(t.getSocketClientFunctions().publishMessage,function(i){n.$broadcast(t.getSocketClientFunctions().publishMessage,i)});i.on(t.getSocketClientFunctions().postLikesUpdate,function(i){n.$broadcast(t.getSocketClientFunctions().postLikesUpdate,i)});i.on(t.getSocketClientFunctions().commentLikesUpdate,function(i){n.$broadcast(t.getSocketClientFunctions().commentLikesUpdate,i)});i.on(t.getSocketClientFunctions().commentAdded,function(i){n.$broadcast(t.getSocketClientFunctions().commentAdded,i)})}return{emit:function(t,r,u){return i.connected&&typeof io!="undefined"&&i.emit(t,r,function(){var t=arguments;return n.$apply(function(){u&&u.apply(i,t)}),!0}),!1}}}]);ngTags=angular.module("ngTags",[]);ngTags.directive("tagItem",[function(){var n=function(){};return n.$inject=["$scope"],{restrict:"EA",scope:{tag:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"tags/tagItem.html",controller:n}}]);ngTags.factory("tagsService",["$http","$q","configProvider",function(n,t,i){var r=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"tags":i.getSettings().BlogApi+"tags";return{getTagsByName:function(i){var u=t.defer();return n({url:r+"/"+i,method:"GET"}).success(function(n){var t=[];_.each(n,function(n){t.push({text:n.TagName})});u.resolve(t)}).error(function(){u.reject("An error occurred!")}),u.promise}}}]);ngUser=angular.module("ngUser",["LocalStorageModule","ngSanitize","ngShared","ngComments","ngPosts","ngLogin","ngConfig","angularFileUpload"]);ngUser.controller("userProfileCommentsController",["$scope","$rootScope","$stateParams","commentsService","userService","errorService","localStorageService",function(n,t,i,r,u,f,e){n.user=null;n.loggedUser=null;n.comments=[];n.isBusy=!1;n.username=t.$stateParams.username==null||t.$stateParams.username==="undefined"?e.get("username"):t.$stateParams.username;n.init=function(){(t.$stateParams.username!=null||t.$stateParams.username!=="undefined")&&n.getUserInfo();t.$broadcast("updateScrollTriggerWatch","user-profile-comments-list")};n.getUserInfo=function(){n.username?u.getUserInfo(n.username).then(function(t){t.Error==null?(n.user=t,n.getCommentsByUser()):f.displayError(t.Error)},function(n){f.displayError(n)}):f.displayError({Message:"User lookup failed. Sorry. :("})};n.getCommentsByUser=function(){n.isBusy||(n.isBusy=!0,r.getCommentsByUser(n.user.Id).then(function(t){_.each(t,function(t){t.User=n.user;t.NameDisplay=n.user.FirstName+" "+n.user.LastName});n.comments=t;n.isBusy=!1},function(n){f.displayError(n)}))};n.init()}]);ngUser.controller("userProfileController",["$scope","$location","$rootScope","localStorageService","userService","errorService","authenticationService",function(n,t,i,r,u,f,e){n.user=null;n.userFullName=null;n.username=null;n.init=function(){i.$stateParams.username==null||i.$stateParams.username==="undefined"?(n.username=r.get("username"),n.username==undefined||n.username==null?f.displayErrorRedirect({Message:"You are not logged in. Try logging in or maybe create an account and join us."}):e.getUserInfo().then(function(t){(t.Message!=undefined||t.Message!=null)&&f.displayError(t.Message);n.getUserInfo()})):(n.username=i.$stateParams.username,n.getUserInfo())};n.getUserInfo=function(){u.getUserInfo(n.username).then(function(t){t.Error==null?(n.user=t,n.userFullName=n.user.FirstName+" "+n.user.LastName,i.$broadcast("viewedUserLoaded",t),delete t.Education,delete t.Address,delete t.Hobbies):f.displayError(t.Error)},function(n){f.displayErrorRedirect(n)})};i.$watch("user",function(){i.user&&(n.user=i.user,n.userFullName=n.user.FirstName+" "+n.user.LastName,n.$broadcast("viewedUserLoaded",n.user))});n.init()}]);ngUser.controller("userProfileFavoritesController",["$scope","$stateParams","userService","blockUiService","errorService",function(){}]);ngUser.controller("userProfileMediaController",["$scope","$rootScope","$stateParams","userService","albumService","errorService","localStorageService",function(n,t,i,r,u,f,e){n.user=null;n.albums=[];n.isBusy=!1;n.username=t.$stateParams.username==null||t.$stateParams.username==="undefined"?e.get("username"):t.$stateParams.username;n.init=function(){(t.$stateParams.username!=null||t.$stateParams.username!=="undefined")&&n.getUserInfo()};n.getUserInfo=function(){n.username?r.getUserInfo(n.username).then(function(t){t.Error==null?(n.user=t,n.getMediaByUser()):f.displayError(t.Error)},function(n){f.displayError(n)}):f.displayError({Message:"User lookup failed. Sorry. :("})};n.getMediaByUser=function(){n.isBusy||(n.isBusy=!0,u.getAlbumsByUser(n.user.Id).then(function(t){n.albums=t;n.isBusy=!1},function(n){f.displayError(n)}))};t.$watch("user",function(){t.user&&(n.user=t.user,n.getMediaByUser())});n.init()}]);ngUser.controller("userProfilePostsController",["$scope","$rootScope","$stateParams","userService","postsService","errorService","localStorageService",function(n,t,i,r,u,f,e){n.user=null;n.posts=[];n.isBusy=!1;n.username=t.$stateParams.username==null||t.$stateParams.username==="undefined"?e.get("username"):t.$stateParams.username;n.size="";n.init=function(){(t.$stateParams.username!=null||t.$stateParams.username!=="undefined")&&n.getUserInfo();t.$broadcast("updateScrollTriggerWatch","user-profile-posts-list")};t.$watch("user",function(){t.user&&(n.user=t.user,n.getPostsByUser())});n.getUserInfo=function(){n.isBusy||(n.isBusy=!0,n.username?r.getUserInfo(n.username).then(function(t){t.Error==null?(n.user=t,n.isBusy=!1,n.getPostsByUser()):f.displayError(t.Error)},function(n){f.displayError(n)}):f.displayError({Message:"User lookup failed. Sorry. :("}))};n.getPostsByUser=function(){n.isBusy||(n.isBusy=!0,u.getPostsByUser(n.user.Id).then(function(t){n.posts=t;n.isBusy=!1;n.$broadcast("resizeIsotopeItems")},function(n){f.displayError(n)}))};n.getMorePostsByUser=function(){n.isBusy||(n.isBusy=!0,u.getMorePostsByUser(n.user.Id,n.posts.length).then(function(t){_.each(t,function(t){n.posts.push(t)});n.isBusy=!1;n.$broadcast("resizeIsotopeItems")},function(n){f.displayError(n)}))};n.$on("scrollBottom",function(){n.getMorePostsByUser()});n.$on("updateUserPostsSize",function(t,i){n.size=i});n.init()}]);ngUser.directive("userImage",[function(){var n=function(n,t,i,r,u,f){n.authData=null;n.username=null;n.albumName=null;n.profileImageUrl=null;n.backgroundImageUrl=null;n.uploadUrl=null;n.showUpdateImages=function(){return n.authData&&n.user&&n.user.UserName===n.username?!0:!1};n.updateProfileImage=function(){n.albumName="profile"};n.updateBackgroundImage=function(){n.albumName="background"};n.$watch("user",function(){n.user!==null&&n.user!==undefined&&(n.profileImageUrl=n.user.Picture.MediaUrl,n.backgroundImageUrl=n.user.Background.MediaUrl)});n.$watch("username",function(){n.username!==null&&n.username!==undefined&&(n.uploadUrl=r.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"media?username="+n.username:r.getSettings().BlogApi+"media?username="+n.username)});n.init=function(){n.authData=f.get("authorizationData");n.username=f.get("username")};n.init();var e=n.uploader=new u({scope:t,url:n.uploadUrl,headers:{Authorization:"Bearer "+(n.authData?n.authData.token:"")},autoUpload:!0});e.filters.push({name:"imageFilter",fn:function(n){var t=e.isHTML5?n.type:"/"+n.value.slice(n.value.lastIndexOf(".")+1);return t="|"+t.toLowerCase().slice(t.lastIndexOf("/")+1)+"|","|jpg|png|jpeg|bmp|".indexOf(t)!==-1}});e.onSuccessItem=function(t,i){n.albumName==="profile"?n.profileImageUrl=i.MediaUrl:n.albumName==="background"&&(n.backgroundImageUrl=i.MediaUrl)};e.onAfterAddingFile=function(t){t.url=n.uploadUrl+"&album="+n.albumName}};return n.$inject=["$scope","$rootScope","userService","configProvider","FileUploader","localStorageService"],{restrict:"EA",scope:{user:"=",fullname:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userImage.html",controller:n}}]);ngUser.directive("userProfileDetails",[function(){var n=function(){};return n.$inject=["$scope"],{restrict:"EA",scope:{user:"=",fullname:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetails.html",controller:n}}]);ngUser.directive("userProfileDetailsAddress",[function(){var n=function(n,t,i,r,u){n.isEditing=!1;n.address={};n.error={};n.username=u.get("username");n.editAddress=function(){n.isEditing=!0};n.cancelEditAddress=function(){n.isEditing=!1};n.saveAddress=function(){r.updateUserAddress(n.address).then(function(t){t.Error==null?n.address=t:i.displayError(t.Error);n.isEditing=!1},function(t){n.setModelStateErrors(t.ModelState)})};n.setModelStateErrors=function(t){var i,r;for(i in t)r=i.toString().split(".")[1],n.error[r]=t[i][0]};n.hasError=function(t){return n.error[t]==undefined?"":"has-error"};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""};n.$on("viewedUserLoaded",function(t,i){n.address=i.Address;n.user=i})};return n.$inject=["$scope","$rootScope","errorService","userService","localStorageService"],{restrict:"EA",replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsAddress.html",controller:n}}]);ngUser.directive("userProfileDetailsEducation",[function(){var n=function(n,t,i){n.$on("viewedUserLoaded",function(t,r){n.educationGroups=r.EducationGroups;n.user=r;_.each(n.educationGroups,function(n){n.isAdding=!1;_.each(n.Content,function(n){n.YearAttendedDisplay=i.getMonthYear(n.YearAttended);n.YearGraduatedDisplay=i.getMonthYear(n.YearGraduated)})})})};return n.$inject=["$scope","$rootScope","dateHelper"],{restrict:"EA",replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsEducation.html",controller:n}}]);ngUser.directive("userProfileDetailsEducationGroup",[function(){var n=function(n,t){n.username=t.get("username");n.isAdding=!1;n.newEducation={City:"",Country:"",Course:"",EducationType:{EducationTypeId:n.educationGroup.EducationType,EducationTypeName:n.educationGroup.Title},SchoolName:"",State:"",UserId:n.user.Id,YearAttended:"",YearAttendedDisplay:"",YearGraduated:"",YearGraduatedDisplay:""};n.emptyRecordMessage="This person has no "+n.educationGroup.Title+" education..pathetic right?";n.addEducation=function(){n.isAdding=!0};n.showNoRecordsMessage=function(){return n.educationGroup.Content.length>0||n.isAdding?!1:!0};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""};n.$on("cancelAddingUserEducation",function(){n.newEducation={City:"",Country:"",Course:"",EducationType:{EducationTypeId:n.educationGroup.type,EducationTypeName:n.educationGroup.title},SchoolName:"",State:"",UserId:n.user.Id,YearAttended:"",YearAttendedDisplay:"",YearGraduated:"",YearGraduatedDisplay:""};n.isAdding=!1});n.$on("successAddingUserEducation",function(t,i){n.educationGroup.Content.push(i)});n.$on("successDeletingUserEducation",function(t,i){var r=n.educationGroup.Content.indexOf(i);n.educationGroup.Content.splice(r,1)})};return n.$inject=["$scope","localStorageService"],{restrict:"EA",scope:{educationGroup:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsEducationGroup.html",controller:n}}]);ngUser.directive("userProfileDetailsEducationItem",[function(){var n=function(n,t,i,r,u,f){n.username=f.get("username");n.isEditing=n.isAdding==undefined?!1:n.isAdding==="false"?!1:!0;n.editEducation=function(){n.isEditing=!0};n.cancelEditing=function(){var t=n.isAdding==undefined?!1:n.isAdding==="false"?!1:!0;if(t){n.$emit("cancelAddingUserEducation");return}n.isEditing=!1};n.saveEducation=function(){var t=n.isAdding==undefined?!1:n.isAdding==="false"?!1:!0;t?n.addEducation():n.updateEducation()};n.deleteEducation=function(){t.deleteUserEducation(n.education.EducationId).then(function(t){t.Error!=null&&u.displayError(t.Error);n.$emit("successDeletingUserEducation",n.education)},function(t){n.setModelStateErrors(t.ModelState)})};n.addEducation=function(){n.education.UserId=n.user.Id;t.addUserEducation(n.education).then(function(t){t.Error!=null&&u.displayError(t.Error);t.YearAttendedDisplay=i.getMonthYear(t.YearAttended);t.YearGraduatedDisplay=i.getMonthYear(t.YearGraduated);n.$emit("successAddingUserEducation",t);n.$emit("cancelAddingUserEducation")},function(t){n.setModelStateErrors(t.ModelState)})};n.updateEducation=function(){t.updateUserEducation(n.education).then(function(t){t.Error!=null&&u.displayError(t.Error);n.isEditing=!1},function(t){n.setModelStateErrors(t.ModelState)})};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""}};return n.$inject=["$scope","userService","dateHelper","blockUiService","errorService","localStorageService"],{restrict:"EA",scope:{education:"=",isAdding:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsEducationItem.html",controller:n}}]);ngUser.directive("userProfileDetailsHobbies",[function(){var n=function(n,t,i,r,u,f){n.isAdding=!1;n.hobbies=[];n.error={};n.newHobby={HobbyName:""};n.emptyRecordMessage="Uhhh..a no lifer..";n.username=f.get("username");n.addHobby=function(){n.isAdding=!0};n.cancelAdding=function(){n.isAdding=!1};n.saveHobby=function(){n.newHobby.UserId=n.user.Id;u.addUserHobby(n.newHobby).then(function(t){t.Error==null?(n.hobbies.push(t),n.newHobby={HobbyName:"",UserId:n.user}):r.displayError(t.Error);n.isAdding=!1},function(t){n.setModelStateErrors(t.ModelState)})};n.$on("successDeletingUserHobby",function(t,i){var r=n.hobbies.indexOf(i);n.hobbies.splice(r,1)});n.showNoRecordsMessage=function(){return n.hobbies.length>0?!1:!0};n.setModelStateErrors=function(t){var i,r;for(i in t)r=i.toString().split(".")[1],n.error[r]=t[i][0]};n.hasError=function(){return n.error.HobbyName==undefined||n.error.HobbyName==""?"":"has-error"};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""};n.$on("viewedUserLoaded",function(t,i){n.hobbies=i.Hobbies;n.user=i})};return n.$inject=["$scope","$rootScope","blockUiService","errorService","userService","localStorageService"],{restrict:"EA",replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsHobbies.html",controller:n}}]);ngUser.directive("userProfileDetailsHobbyItem",[function(){var n=function(n,t,i,r,u){n.isEditing=!1;n.error={};n.hobbyNameStore="";n.username=u.get("username");n.cancelEditing=function(){n.hobby.HobbyName=n.hobbyNameStore;n.isEditing=!1};n.editHobby=function(){n.hobbyNameStore=n.hobby.HobbyName;n.isEditing=!0};n.saveHobby=function(){r.updateUserHobby(n.hobby).then(function(t){t.Error!=null&&i.displayError(t.Error);n.isEditing=!1},function(t){n.setModelStateErrors(t.ModelState)})};n.deleteHobby=function(){r.deleteUserHobby(n.hobby.HobbyId).then(function(t){t.Error!=null&&i.displayError(t.Error);n.$emit("successDeletingUserHobby",n.hobby)},function(t){n.setModelStateErrors(t.ModelState)})};n.setModelStateErrors=function(t){var i,r;for(i in t)r=i.toString().split(".")[1],n.error[r]=t[i][0]};n.hasError=function(){return n.error.HobbyName==undefined||n.error.HobbyName==""?"":"has-error"};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""}};return n.$inject=["$scope","blockUiService","errorService","userService","localStorageService"],{restrict:"EA",scope:{hobby:"=",user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsHobbyItem.html",controller:n}}]);ngUser.directive("userProfileDetailsInfo",[function(){var n=function(n,t,i,r){n.isEditing=!1;n.userFullName=null;n.error={};n.username=r.get("username");n.editDetails=function(){n.isEditing=!0};n.cancelEditDetails=function(){n.isEditing=!1};n.saveDetails=function(){i.updateUser(n.user).then(function(i){i.Error==null?(delete i.Education,delete i.Address,delete i.Hobbies,n.user=i,n.userFullName=n.user.FirstName+" "+n.user.LastName,n.isEditing=!1):(t.displayError(i.Error),n.isEditing=!1)},function(t){n.setModelStateErrors(t.ModelState)})};n.setModelStateErrors=function(t){var i,r;for(i in t)r=i.toString().split(".")[1],n.error[r]=t[i][0]};n.hasError=function(t){return n.error[t]==undefined?"":"has-error"};n.showButtons=function(){return n.username==undefined||n.username==null||n.username==""?"hidden":n.user==undefined?"hidden":n.username!==n.user.UserName?"hidden":""}};return n.$inject=["$scope","errorService","userService","localStorageService"],{restrict:"EA",scope:{user:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileDetailsInfo.html",controller:n}}]);ngUser.directive("userProfileNavigation",[function(){var n=function(n){n.aboutUrl=n.username==null||n.username==="undefined"?"/#/user":"#/user/"+n.username;n.postsUrl=n.username==null||n.username==="undefined"?"/#/user/posts":"#/user/"+n.username+"/posts";n.commentsUrl=n.username==null||n.username==="undefined"?"/#/user/comments":"#/user/"+n.username+"/comments";n.mediaUrl=n.username==null||n.username==="undefined"?"/#/user/media":"#/user/"+n.username+"/media";n.favoritesUrl=n.username==null||n.username==="undefined"?"/#/user/favorites":"#/user/"+n.username+"/favorites"};return n.$inject=["$scope"],{restrict:"EA",scope:{username:"="},replace:!0,templateUrl:window.blogConfiguration.templatesModulesUrl+"user/userProfileNavigation.html",controller:n}}]);ngUser.factory("userService",["$http","$q","configProvider","dateHelper",function(n,t,i,r){var e=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Users":i.getSettings().BlogApi+"Users",o=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Address":i.getSettings().BlogApi+"Address",u=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Hobbies":i.getSettings().BlogApi+"Hobbies",f=i.getSettings().BlogApi==""?window.blogConfiguration.blogApi+"Education":i.getSettings().BlogApi+"Education",s=function(n){return n.BirthDateDisplay=r.getJsDate(n.BirthDate),n.BirthDate=r.getJsFullDate(n.BirthDate),n.FirstName==null&&(n.FirstName="n/a"),n.LastName==null&&(n.LastName="n/a"),n.Picture==null&&(n.Picture={MediaUrl:i.getDefaults().profilePictureUrl}),n.Background==null&&(n.Background={MediaUrl:i.getDefaults().backgroundPictureUrl}),n};return{getUserInfo:function(i){var r=t.defer();return n({url:e+"/"+i,method:"GET"}).success(function(n){r.resolve(s(n))}).error(function(n){r.reject(n)}),r.promise},updateUser:function(i){var r=t.defer();return n({url:e,method:"PUT",data:i}).success(function(n){r.resolve(s(n))}).error(function(n){r.reject(n)}),r.promise},addUserAddress:function(i){var r=t.defer();return n({url:o,method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},updateUserAddress:function(i){var r=t.defer();return n({url:o,method:"PUT",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},addUserHobby:function(i){var r=t.defer();return n({url:u,method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},updateUserHobby:function(i){var r=t.defer();return n({url:u,method:"PUT",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},deleteUserHobby:function(i){var r=t.defer();return n({url:u+"/"+i,method:"DELETE"}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},addUserEducation:function(i){var r=t.defer();return n({url:f,method:"POST",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},updateUserEducation:function(i){var r=t.defer();return n({url:f,method:"PUT",data:i}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise},deleteUserEducation:function(i){var r=t.defer();return n({url:f+"/"+i,method:"DELETE"}).success(function(n){r.resolve(n)}).error(function(n){r.reject(n)}),r.promise}}}]);
/*
//# sourceMappingURL=appmodules.min.js.map
*/